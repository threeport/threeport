// generated by 'threeport-codegen api-model' - do not edit

package v0

import (
	"encoding/json"
	"fmt"
	notifications "github.com/threeport/threeport/pkg/notifications"
)

const (
	ObjectTypeWorkloadDependency ObjectType = "WorkloadDependency"

	DependencyStreamName = "dependencyStream"

	WorkloadDependencySubject       = "workloadDependency.*"
	WorkloadDependencyCreateSubject = "workloadDependency.create"
	WorkloadDependencyUpdateSubject = "workloadDependency.update"
	WorkloadDependencyDeleteSubject = "workloadDependency.delete"

	PathWorkloadDependencies = "/v0/workload-dependencies"
)

// GetWorkloadDependencySubjects returns the NATS subjects
// for workload dependencies.
func GetWorkloadDependencySubjects() []string {
	return []string{
		WorkloadDependencyCreateSubject,
		WorkloadDependencyUpdateSubject,
		WorkloadDependencyDeleteSubject,
	}
}

// GetDependencySubjects returns the NATS subjects
// for all dependency objects.
func GetDependencySubjects() []string {
	var dependencySubjects []string

	dependencySubjects = append(dependencySubjects, GetWorkloadDependencySubjects()...)

	return dependencySubjects
}

// NotificationPayload returns the notification payload that is delivered to the
// controller when a change is made.  It includes the object as presented by the
// client when the change was made.
func (wd *WorkloadDependency) NotificationPayload(
	operation notifications.NotificationOperation,
	requeue bool,
	lastDelay int64,
) (*[]byte, error) {
	notif := notifications.Notification{
		LastRequeueDelay: &lastDelay,
		Object:           wd,
		Operation:        operation,
		Requeue:          requeue,
	}

	payload, err := json.Marshal(notif)
	if err != nil {
		return &payload, fmt.Errorf("failed to marshal notification payload %+v: %w", wd, err)
	}

	return &payload, nil
}

// GetID returns the unique ID for the object.
func (wd *WorkloadDependency) GetID() uint {
	return *wd.ID
}

// String returns a string representation of the ojbect.
func (wd WorkloadDependency) String() string {
	return fmt.Sprintf("v0.WorkloadDependency")
}
